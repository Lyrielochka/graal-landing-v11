<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mordred Forge — проекты со смыслом</title>
  <meta name="description" content="Mordred Forge: лендинги, школьные ресурсы, свадебные мини-порталы и корпоративные веб-площадки. Тёмно-золотая эстетика, анимированный фон и читабельные шрифты." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;800;900&family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#07090c; --ink:#ecf1f8; --muted:#a9b5c9; --gold:#e2c06b; --gold-2:#ad8b3f;
      --line:#1a2230; --radius:20px; --shadow:0 24px 70px rgba(0,0,0,.7); --chip:#0d1322;

      /* УКАЖИ СВОЙ ФАЙЛ ЛОГОТИПА ДЛЯ ФОНА: PNG/SVG рядом со страницей */
      --logo-bg: url("logo-bg.png");
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}

    body{
      margin:0;color:var(--ink);
      font:16px/1.65 Manrope,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      overflow-x:hidden;text-align:center; position:relative;
    }

    /* === БОЛЬШОЙ РАЗМЫТЫЙ ФОН ИЗ ЛОГОТИПА (ТОЧНО ВИДЕН) === */
    body::before{
      content:"";
      position:fixed; inset:-15%;
      z-index:-2; /* ЛОГОТИП выше #bgdark (-3), ниже canvas (-1) */
      pointer-events:none;
      background: var(--logo-bg) no-repeat center;
      background-size: 120vmin;   /* размер лого на экране */
      filter: blur(46px);
      opacity:.22;                /* при желании увеличь/уменьши */
      transform: translateZ(0);
    }
    @media (max-width:680px){
      body::before{ background-size:150vmin; filter:blur(38px); opacity:.18; }
    }

    a{color:inherit;text-decoration:none} img{display:block;max-width:100%}
    .wrap{width:min(1120px,92vw);margin-inline:auto;padding-inline:22px}

    /* СЛОИ ФОНА */
    #bgdark{position:fixed;inset:0;z-index:-3; /* ниже логотипа */
      background:radial-gradient(55% 50% at 50% 45%,#05070a 0%,#020305 70%)}
    #bgfx{position:fixed;inset:0;z-index:-1; /* выше логотипа */
      pointer-events:none;mix-blend-mode:screen;opacity:.78}

    .progress{
      position:fixed; inset:0 0 auto 0;
      height:3px;background:linear-gradient(90deg,transparent,var(--gold));
      transform-origin:0 50%; transform:scaleX(0);
      z-index:50; box-shadow:0 0 16px rgba(226,192,107,.35)
    }

    /* === Простой прелоадер: только спиннер === */
    #preloader{
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:#07090c; z-index:9999;
      transition:opacity .35s ease, visibility .35s ease;
    }
    #preloader.hidden{opacity:0; visibility:hidden}
    #preloader .holder{display:grid;place-items:center}
    .spinner{
      width:56px; height:56px; border-radius:50%;
      border:6px solid rgba(226,192,107,.25);
      border-top-color:rgba(226,192,107,.9);
      animation:spin .9s linear infinite;
    }
    @media (prefers-reduced-motion:reduce){
      #preloader{transition:none}
      .spinner{animation:none}
    }

    header{position:sticky;top:0;z-index:10;backdrop-filter:blur(10px) saturate(120%);
      background:linear-gradient(180deg,rgba(6,8,12,.85) 0%,rgba(6,8,12,0) 100%);
      border-bottom:1px solid rgba(255,255,255,.02)}
    .nav{height:86px;display:flex;align-items:center;justify-content:center;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:40px;height:40px;border-radius:50%;box-shadow:0 0 0 1px rgba(226,192,107,.45)}
    .brand b{font-family:"Cinzel",serif;font-weight:900;letter-spacing:.6px;font-size:20px;text-shadow:0 0 18px rgba(226,192,107,.12)}
    .actions{display:flex;gap:10px;margin-left:16px}
    .btn{display:inline-flex;align-items:center;gap:10px;height:46px;padding:0 16px;border-radius:16px;border:1px solid var(--line);background:linear-gradient(180deg,#0c1220,#0a0f1a);box-shadow:var(--shadow);font-weight:800;line-height:1;transition:.3s}
    .btn:hover{transform:translateY(-1px)} .btn.ghost{background:#0d1322;border-color:#223149}
    .btn .tg{width:18px;height:18px;display:inline-block}.btn .tg svg{width:100%;height:100%}

    @media (max-width:680px){
      .nav{height:auto;padding:10px 0;flex-wrap:wrap;justify-content:space-between}
      .brand img{width:34px;height:34px} .brand b{font-size:18px;letter-spacing:.4px}
      .actions{order:2;width:100%;justify-content:flex-end;gap:8px;margin-left:0}
      .btn{height:40px;padding:0 12px;border-radius:14px}
    }

    .hero{position:relative;padding:clamp(64px,7vw,96px) 0 16px}
    .kicker{color:var(--muted);text-transform:uppercase;letter-spacing:.18em;font-size:12px}
    h1{font-family:"Cinzel",serif;font-weight:900;letter-spacing:.01em;font-size:clamp(38px,6vw,72px);line-height:1.06;margin:8px 0 10px;background:linear-gradient(92deg,var(--ink),#f5f7fd);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 2px 28px rgba(0,0,0,.65)}
    .lead{max-width:900px;margin:0 auto;font-size:clamp(17px,2.2vw,20px);font-weight:600;color:#e3e8f3;text-shadow:0 1px 16px rgba(0,0,0,.55)}

    .halo{position:absolute;inset:auto 0 0 0;height:140px;margin:auto;z-index:0;pointer-events:none;opacity:.25;filter:blur(20px)}
    .ornament-wrap{position:fixed;inset:0;display:grid;place-items:center;z-index:0;pointer-events:none;opacity:.15;filter:drop-shadow(0 0 30px rgba(0,0,0,.5))}
    .ornament{width:min(1200px,90vw)} .ornament .stroke{fill:none;stroke:var(--gold);stroke-opacity:.7;stroke-width:1.3}
    .spin{animation:spin 160s linear infinite}
    @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
    @media (max-width:680px){.ornament-wrap{opacity:.08}.ornament{width:120vw}}

    .section{padding:clamp(28px,5vw,48px) 0}
    .section h2{font-family:"Cinzel",serif;font-weight:800;letter-spacing:.01em;font-size:clamp(26px,4.2vw,44px);margin:0 0 8px;background:linear-gradient(92deg,#f3f4fa,#e6eaf4);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 18px rgba(226,192,107,.08)}
    .sub{color:var(--muted);max-width:780px;margin:0 auto}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:18px}
    .card{grid-column:span 6;background:linear-gradient(180deg,#0a0d13,#080b10);border:1px solid var(--line);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow);position:relative;overflow:hidden;transition:.35s cubic-bezier(.2,.8,.2,1)}
    .card::after{content:"";position:absolute;inset:-40%;background:radial-gradient(320px 180px at var(--mx,60%) var(--my,40%),rgba(226,192,107,.28),transparent 60%);opacity:0;transition:.25s;pointer-events:none}
    .card:hover{transform:translateY(-6px) scale(1.01);box-shadow:0 18px 50px rgba(0,0,0,.6)}
    .card:hover::after{opacity:.9}
    @media(max-width:900px){.card{grid-column:span 12}}

    .tag{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;text-transform:uppercase;letter-spacing:.14em;font-size:12px;color:#0b0c10;background:linear-gradient(180deg,var(--gold),var(--gold-2))}
    .title{margin:12px 0 6px;font-size:clamp(20px,2.5vw,26px);font-family:"Cinzel",serif;font-weight:800;letter-spacing:.01em;background:linear-gradient(92deg,#f3f4fa,#d8def0);-webkit-background-clip:text;background-clip:text;color:transparent}
    .copy{color:#e8ecf6}
    .orn{width:96px;height:10px;margin:12px auto;border-radius:999px;background:linear-gradient(90deg,transparent,rgba(226,192,107,.65),transparent)}
    .price-line{display:flex;justify-content:center;gap:8px;margin-top:8px;font-weight:800;color:#f5f7fd}
    .mini-cta{position:relative;z-index:2;margin-top:12px;display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));font-weight:800}
    .mini-cta:hover{border-color:rgba(255,255,255,.26)}
    .card.universal{grid-column:span 12}
    .card.universal .tag{background:linear-gradient(180deg,rgba(226,192,107,.9),rgba(173,139,63,.9))}

    .contact{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:16px}
    .panel{background:linear-gradient(180deg,#0a0d13,#080b10);border:1px solid var(--line);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)}
    .panel.form{grid-column:span 6} .panel.benefits{grid-column:span 6;text-align:left}
    @media(max-width:900px){.panel.form,.panel.benefits{grid-column:span 12}}

    label{display:block;font-weight:800;margin:8px 0}
    input,textarea{width:100%;background:rgba(255,255,255,.06);color:var(--ink);border:1px solid rgba(255,255,255,.16);border-radius:14px;padding:12px 14px;outline:none;font:inherit;transition:border-color .2s,box-shadow .2s}
    textarea{min-height:120px;resize:vertical}
    input:focus,textarea:focus{border-color:var(--gold);box-shadow:0 0 0 3px rgba(226,192,107,.18)}

    .select{position:relative;user-select:none;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.16);border-radius:14px;padding:0;color:var(--ink)}
    .select-btn{display:flex;justify-content:space-between;align-items:center;width:100%;padding:12px 14px;background:transparent;border:0;color:inherit;font:inherit;border-radius:14px;cursor:pointer}
    .select-btn:focus{outline:none;box-shadow:0 0 0 3px rgba(226,192,107,.18)}
    .select-list{position:absolute;left:0;right:0;top:calc(100% + 6px);background:var(--chip);color:var(--ink);border:1px solid #223149;border-radius:14px;box-shadow:0 18px 44px rgba(0,0,0,.6);padding:6px;display:none;z-index:20;max-height:240px;overflow:auto}
    .select.open .select-list{display:block}
    .option{text-align:left;padding:10px 12px;border-radius:10px;cursor:pointer}
    .option[aria-selected="true"],.option:hover{background:#0b0f1d}
    .select .chev{width:18px;height:18px;flex:0 0 18px;opacity:.8}

    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:680px){.form-row{grid-template-columns:1fr}}

    .submit{display:inline-flex;align-items:center;gap:10px;padding:14px 18px;border-radius:999px;font-weight:900;border:0;color:#0b0c10;background:linear-gradient(180deg,var(--gold),var(--gold-2)),radial-gradient(120% 180% at 50% -40%,rgba(255,255,255,.3),transparent 60%);box-shadow:var(--shadow);transition:.3s}
    .submit:hover{transform:translateY(-1px);box-shadow:0 16px 44px rgba(226,192,107,.26)}
    .note{margin-top:8px;color:var(--muted);font-size:14px;text-align:center}

    footer{padding:28px 0 48px;color:#93a4ba}
    .foot{display:flex;align-items:center;justify-content:center;gap:12px}
    .foot img{width:40px;height:40px;border-radius:50%;box-shadow:0 0 0 1px rgba(226,192,107,.45)}
    .foot b{font-family:"Cinzel",serif}

    .reveal{opacity:0;transform:translateY(16px);transition:.8s cubic-bezier(.2,.8,.2,1)}
    .reveal.in{opacity:1;transform:none}
    @media (prefers-reduced-motion:reduce){#bgfx{opacity:.35}.spin{animation:none}.reveal{opacity:1;transform:none}}
  </style>
</head>
<body>
  <!-- Прелоадер -->
  <div id="preloader" aria-live="polite" aria-busy="true">
    <div class="holder"><div class="spinner" role="img" aria-label="Загрузка"></div></div>
  </div>

  <div class="progress" id="progress"></div>
  <div id="bgdark"></div>
  <canvas id="bgfx"></canvas>

  <div class="ornament-wrap" aria-hidden="true">
    <svg class="ornament spin" viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg">
      <g class="stroke">
        <circle cx="400" cy="400" r="300"/><circle cx="400" cy="400" r="220"/><circle cx="400" cy="400" r="160"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(0 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(45 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(90 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(135 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(180 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(225 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(270 400 400)"/>
        <path d="M400 120 C 440 200, 480 320, 400 400" transform="rotate(315 400 400)"/>
        <path d="M120 400 H680 M400 120 V680"/>
      </g>
    </svg>
  </div>

  <header>
    <div class="wrap nav">
      <a class="brand" href="#top" aria-label="Mordred Forge">
        <img src="logo.png" alt="Mordred Forge логотип"><b>Mordred Forge</b>
      </a>
      <div class="actions">
        <a class="btn ghost" href="https://t.me/graal.studio" target="_blank" rel="noopener">
          <span class="tg" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M9.5 15.3l-.2 3c.3 0 .5-.1.6-.2l1.4-1.3 2.9 2.1c.5.3.9.1 1-.5l2-9.6c.2-.8-.3-1.1-.8-1L4.7 10c-.8.2-.8.6-.1.8l3.5 1.1 8.1-5.1-6.7 6.1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>Telegram
        </a>
        <a class="btn ghost" href="#contact">Связаться</a>
      </div>
    </div>
  </header>

  <section class="hero wrap" id="top">
    <p class="kicker reveal">ДИЗАЙН · РАЗРАБОТКА · ЗАПУСК</p>
    <h1 class="reveal" id="title">Каждый проект — достойный рыцарский подвиг</h1>
    <div class="halo" id="halo" aria-hidden="true"></div>
    <p class="lead reveal">Создаём страницы, которые цепляют с первого экрана: артурианская эстетика, скорость и понятная подача ценности.</p>
  </section>

  <section class="section wrap" id="work">
    <h2 class="reveal">Наши решения</h2>
    <p class="sub reveal">Форматы под разные задачи. Прозрачные цены — в USD и BYN.</p>

    <div class="grid">
      <article class="card reveal" style="transition-delay:.05s">
        <div class="tag">Graal One-Page</div>
        <div class="title">Одностраничник / Лендинг</div>
        <p class="copy">Идеален для личного бренда, малого бизнеса или одной услуги. Быстрый старт и сильный первый экран.</p>
        <div class="orn"></div>
        <div class="price-line">$100 (300 BYN)</div>
        <a class="mini-cta" href="#contact" data-type="Graal One-Page">Хочу такой</a>
      </article>

      <article class="card reveal" style="transition-delay:.08s">
        <div class="tag">Graal Wedding</div>
        <div class="title">Свадебный мини-портал</div>
        <p class="copy">Приглашение, тайминг, локации, список подарков и RSVP — всё в одной стильной ссылке.</p>
        <div class="orn"></div>
        <div class="price-line">$75 (220 BYN)</div>
        <a class="mini-cta" href="#contact" data-type="Graal Wedding">Собрать пригласительный</a>
      </article>

      <article class="card reveal" style="transition-delay:.11s">
        <div class="tag">Graal School</div>
        <div class="title">Школьный ресурс</div>
        <p class="copy">Новости, расписание, учителя и документы — в чёткой структуре, без перегруза.</p>
        <div class="orn"></div>
        <div class="price-line">$250 (750 BYN)</div>
        <a class="mini-cta" href="#contact" data-type="Graal School">Обновить ресурс</a>
      </article>

      <article class="card reveal" style="transition-delay:.14s">
        <div class="tag">Graal Corporate</div>
        <div class="title">Корпоративная веб-площадка</div>
        <p class="copy">Услуги, кейсы, блог, формы заявок и интеграции. Платформа, которая работает на бизнес.</p>
        <div class="orn"></div>
        <div class="price-line">$300 (900 BYN)</div>
        <a class="mini-cta" href="#contact" data-type="Graal Corporate">Запустить проект</a>
      </article>

      <article class="card universal reveal" style="transition-delay:.17s">
        <div class="tag">Graal Universal</div>
        <div class="title">Универсальный пакет</div>
        <p class="copy">Под конкретную задачу и бюджет. Согласуем конфигурацию без переплаты — честно и прозрачно.</p>
        <div class="orn"></div>
        <div class="price-line">Индивидуально</div>
        <a class="mini-cta" href="#contact" data-type="Graal Universal">Обсудить детали</a>
      </article>
    </div>
  </section>

  <section class="section wrap" id="contact">
    <h2 class="reveal">Связаться с нами</h2>
    <p class="sub reveal">Расскажите пару деталей — ответим тем же днём и предложим лучший формат.</p>

    <div class="contact">
      <form class="panel form reveal" id="lead" novalidate>
        <div class="form-row">
          <div>
            <label for="name">Имя</label>
            <input id="name" name="name" type="text" placeholder="Как к вам обращаться" required>
          </div>
          <div>
            <label for="contactField">Телефон или email</label>
            <input id="contactField" name="contact" type="text" placeholder="@mail или +375…" required>
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="type">Тип проекта</label>
            <input type="hidden" name="type" id="type" value="Graal One-Page">
            <div class="select" data-for="type">
              <button class="select-btn" type="button"><span class="select-value">Graal One-Page</span>
                <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </button>
              <div class="select-list" role="listbox">
                <div class="option" data-value="Graal One-Page" aria-selected="true">Graal One-Page</div>
                <div class="option" data-value="Graal Wedding">Graal Wedding</div>
                <div class="option" data-value="Graal School">Graal School</div>
                <div class="option" data-value="Graal Corporate">Graal Corporate</div>
                <div class="option" data-value="Graal Universal">Graal Universal</div>
              </div>
            </div>
          </div>

          <div>
            <label for="budget">Бюджет</label>
            <input type="hidden" name="budget" id="budget" value="до $100">
            <div class="select" data-for="budget">
              <button class="select-btn" type="button"><span class="select-value">до $100</span>
                <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </button>
              <div class="select-list" role="listbox">
                <div class="option" data-value="до $100" aria-selected="true">до $100</div>
                <div class="option" data-value="$100 — $250">$100 — $250</div>
                <div class="option" data-value="$250 — $500">$250 — $500</div>
                <div class="option" data-value="обсудим">обсудим</div>
              </div>
            </div>
          </div>
        </div>

        <label for="msg">Коротко о задаче</label>
        <textarea id="msg" name="message" placeholder="Что нужно сделать, сроки, примеры…"></textarea>

        <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:8px">
          <button class="submit" type="submit">Отправить заявку</button>
        </div>
        <div id="formNote" class="note" role="status" aria-live="polite"></div>
      </form>

      <aside class="panel benefits reveal">
        <h3 style="margin:0 0 6px;font-family:'Cinzel',serif;font-weight:800">Наши преимущества</h3>
        <ul style="list-style:none;padding:0;margin:8px 0 0;display:grid;gap:10px">
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Начинаем с диалога.</b> Сначала цель, аудитория и история бренда — потом макеты и код.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Индивидуальный маршрут.</b> Подбираем эстетику, структуру и функции под вашу задачу.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Сопровождение до результата.</b> На связи до запуска и после — мелкие правки включены.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Честные сроки и стоимость.</b> Фиксируем этапы, без скрытых «звёздочек» и доплат.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Лёгкость и скорость.</b> Адаптив на всех устройствах, быстрая загрузка и понятная навигация.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Помощь с текстами.</b> Перепишем и упростим формулировки — без канцелярита.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Аналитика и заявки.</b> Подключаем отслеживание, сообщения приходят в один клик.</div></li>
          <li style="display:flex;gap:10px;align-items:flex-start"><span style="color:var(--gold)">✦</span><div><b>Гибкие пакеты.</b> Найдём конфигурацию под любой бюджет — без потери смысла.</div></li>
        </ul>
      </aside>
    </div>
  </section>

  <footer>
    <div class="wrap foot">
      <img src="logo.png" alt="Mordred Forge"><span>© <b id="year"></b> Mordred Forge · Все права защищены</span>
    </div>
  </footer>

  <script>
    /* ===== Canvas фон ===== */
    const c=document.getElementById('bgfx'),ctx=c.getContext('2d');let W,H,DPR=Math.min(devicePixelRatio||1,2);let EMBERS=120,CLOUDS=6,OPACITY=.78;
    function rs(){const isMobile=innerWidth<=680;DPR=Math.min(devicePixelRatio||1,isMobile?1.5:2);EMBERS=isMobile?70:120;CLOUDS=isMobile?4:6;OPACITY=isMobile?.6:.78;c.style.opacity=OPACITY;W=c.width=Math.floor(innerWidth*DPR);H=c.height=Math.floor(innerHeight*DPR);c.style.width=innerWidth+'px';c.style.height=innerHeight+'px';build()}
    const embers=[],clouds=[];function build(){embers.length=0;for(let i=0;i<EMBERS;i++){embers.push({x:Math.random()*W,y:Math.random()*H,r:(Math.random()*1.8+0.7)*DPR,vx:(Math.random()-.5)*.10*DPR,vy:-(Math.random()*.20+.06)*DPR,a:Math.random()*.8+.2})}clouds.length=0;for(let i=0;i<CLOUDS;i++){clouds.push({x:Math.random()*W,y:Math.random()*H,rx:(500+Math.random()*480)*DPR,ry:(320+Math.random()*260)*DPR,hue:i%2?45:240,alpha:.07+Math.random()*.05,driftX:(Math.random()-.5)*.05*DPR,driftY:(Math.random()-.5)*.035*DPR})}}
    rs();addEventListener('resize',rs);
    function tick(){ctx.clearRect(0,0,W,H);for(const m of clouds){m.x+=m.driftX;m.y+=m.driftY;if(m.x<-m.rx)m.x=W+m.rx;if(m.x>W+m.rx)m.x=-m.rx;if(m.y<-m.ry)m.y=H+m.ry;if(m.y>H+m.ry)m.y=-m.ry;const g=ctx.createRadialGradient(m.x,m.y,0,m.x,m.y,Math.max(m.rx,m.ry));g.addColorStop(0,`hsla(${m.hue} 60% 65% / ${m.alpha})`);g.addColorStop(1,`hsla(${m.hue} 60% 65% / 0)`);ctx.globalCompositeOperation='screen';ctx.fillStyle=g;ctx.beginPath();ctx.ellipse(m.x,m.y,m.rx,m.ry,0,0,Math.PI*2);ctx.fill()}ctx.globalCompositeOperation='lighter';for(const p of embers){p.x+=p.vx;p.y+=p.vy;if(p.y<-50){p.y=H+50;p.x=Math.random()*W}if(p.x<-50)p.x=W+50;if(p.x>W+50)p.x=-50;const gg=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*14);gg.addColorStop(0,`rgba(226,192,107,${0.12+p.a*0.3})`);gg.addColorStop(1,'rgba(226,192,107,0)');ctx.fillStyle=gg;ctx.beginPath();ctx.arc(p.x,p.y,p.r*14,0,6.283);ctx.fill()}requestAnimationFrame(tick)}requestAnimationFrame(tick);

    /* Hover glow */
    document.querySelectorAll('.card').forEach(card=>{
      card.addEventListener('pointermove',e=>{const r=card.getBoundingClientRect();card.style.setProperty('--mx',((e.clientX-r.left)/r.width*100)+'%');card.style.setProperty('--my',((e.clientY-r.top)/r.height*100)+'%')});
    });

    /* Reveal */
    const io=new IntersectionObserver(es=>es.forEach(en=>{if(en.isIntersecting){en.target.classList.add('in');io.unobserve(en.target)}}),{threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    /* Параллакс-свет под заголовком hero */
    const halo=document.getElementById('halo');window.addEventListener('pointermove',e=>{const x=e.clientX/innerWidth;halo.style.backgroundImage=`radial-gradient(400px 120px at ${x*100}% 40%, rgba(226,192,107,.25), rgba(226,192,107,0))`});

    /* Индикатор прокрутки */
    const progress=document.getElementById('progress');addEventListener('scroll',()=>{const h=document.documentElement;const ratio=(h.scrollTop)/(h.scrollHeight-h.clientHeight);progress.style.transform=`scaleX(${ratio})`},{passive:true});

    /* Кастомные select */
    document.querySelectorAll('.select').forEach(sel=>{
      const btn=sel.querySelector('.select-btn');const list=sel.querySelector('.select-list');const valBox=sel.querySelector('.select-value');const hidden=document.getElementById(sel.dataset.for);
      function closeAll(){document.querySelectorAll('.select.open').forEach(s=>s.classList.remove('open'))}
      btn.addEventListener('click',e=>{e.stopPropagation();const was=sel.classList.contains('open');closeAll();if(!was)sel.classList.add('open')});
      list.querySelectorAll('.option').forEach(opt=>{opt.addEventListener('click',()=>{list.querySelectorAll('.option').forEach(o=>o.removeAttribute('aria-selected'));opt.setAttribute('aria-selected','true');valBox.textContent=opt.dataset.value;hidden.value=opt.dataset.value;sel.classList.remove('open')})});
      document.addEventListener('click',()=>sel.classList.remove('open'));
    });

    /* Mailto форма */
    const form=document.getElementById('lead');const note=document.getElementById('formNote');
    form?.addEventListener('submit',e=>{e.preventDefault();const data=new FormData(form);const name=String(data.get('name')||'').trim();const contact=String(data.get('contact')||'').trim();if(!name||!contact){note.textContent='Пожалуйста, заполните имя и контакт.';note.style.color='#ffca58';return}const subject=encodeURIComponent('Заявка с проекта Mordred Forge');const body=encodeURIComponent([`Имя: ${name}`,`Контакт: ${contact}`,`Тип: ${data.get('type')}`,`Бюджет: ${data.get('budget')}`,`Сообщение: ${data.get('message')||''}`].join('\n'));location.href=`mailto:hello@graal.studio?subject=${subject}&body=${body}`;note.textContent='Готово! Откроется почтовый клиент.';note.style.color='#28d17c';form.reset()});

    /* Мини-CTA */
    document.querySelectorAll('.mini-cta').forEach(btn=>{
      btn.addEventListener('click',e=>{
        e.preventDefault();
        const type = btn.dataset.type;
        const hidden = document.getElementById('type');
        const selectBox = document.querySelector('.select[data-for="type"] .select-value');
        if (type && hidden && selectBox){ hidden.value = type; selectBox.textContent = type; }
        document.getElementById('contact').scrollIntoView({behavior:'smooth'});
        setTimeout(()=> document.getElementById('name')?.focus(), 400);
      });
    });

    document.getElementById('year').textContent=new Date().getFullYear();

    /* Скрываем прелоадер после полной загрузки */
    window.addEventListener('load', () => {
      document.getElementById('preloader')?.classList.add('hidden');
    });
  </script>

  <noscript><style>#preloader{display:none}</style></noscript>
</body>
</html>
